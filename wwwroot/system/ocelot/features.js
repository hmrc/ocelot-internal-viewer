
window.Features = (function () {
	
	function findPID() {
		if (isIE) {
			try {
				var wshshell=new ActiveXObject("wscript.shell");
				var username=wshshell.ExpandEnvironmentStrings("%username%");
				return username;
			} catch(err) {
				var FSO, drvName;
			    FSO = new ActiveXObject("scripting.FileSystemObject");
				drvName = FSO.GetDrive(FSO.GetDriveName("Z:"));
				var drvParts = drvName.ShareName.split("\\");
				if (isNaN(drvParts[4]))	{
				  	return drvParts[5];
				} else {
				  	return drvParts[4];
				}
			}
	    } else {
	    	return 0
	    }
	}
	
	var isIE = "ActiveXObject" in window;
	
	var pidList = [1574043,2166828,2245183,2306123,2671417,2682036,2791188,2836149,2846276,2976390,3009211,3057135,3088502,3578445,3619206,3621510,3650812,3678741,3709337,
         3710831,3762858,3762912,3763765,3765687,3814017,3823407,3824853,3828573,3831574,3860795,3884929,3886476,3895289,3949982,3953564,3957772,3979326,4022289,
         4022440,4023498,4023714,4032241,4032403,4033388,4037375,4038878,4042549,4043677,4046285,4051246,4073517,4073525,4121279,4135016,4166329,4166582,4174496,
         4217780,4233131,4250567,4251547,4253345,4253388,4254902,4255410,4259106,4273737,4275977,4287460,4319311,4325907,4327802,4329112,4336925,4337603,4388879,
         4393120,4401670,4437799,4442938,4447247,4449800,4502469,4568710,4589572,4635833,4639243,4666321,4667182,4754409,4755529,4770994,4795954,4812093,4814479,
         4817192,4848225,4855191,4872398,4894944,4898346,4899768,4964381,5040493,5076412,5101433,5125502,5147506,5193958,5197821,5206448,5265606,5293588,5308771,
         5309999,5326087,5338204,5372399,5576369,5624657,6006806,6007795,6008003,6009008,6013378,6014187,6014961,6017372,6017945,6029015,6031506,6034763,6034936,
         6034940,6035024,6036354,6036648,6037028,6037497,6040345,6046427,6048549,6050419,6055072,6055351,6058824,6059803,6061372,6062668,6064702,6066076,6066289,
         6066407,6077206,6085454,6085730,6087031,6098875,7126380,7127829,7128031,7130185,7131381,7207477,7213699,7213931,7220228,7221453,7222770,7222772,7224566,
         7225729,7226254,7229184,7232748,7232753,7232764,7232766,7232773,7232923,7233540,7233541,7233542,7234105,7234113,7234115,7234118,7234119,7234121,7234123,
         7234161,7234162,7234164,7234165,7234188,7234195,7234301,7234378,7234381,7234382,7234383,7234384,7234394,7234396,7234400,7234401,7234460,7234500,7234502,
         7234503,7234716,7234717,7234718,7234719,7234720,7234722,7234727,7234731,7234736,7234738,7234762,7234763,7234765,7234768,7234781,7234905,7234953,7234994,
         7234996,7234998,7235015,7235088,7235116,7235128,7235324,7235346,7235587,7235614,7235733,7235818,7235824,7235849,7235885,7235886,7235945,7235996,7236367,
         7237069,7237075,7237084,7237138,7237139,7237141,7237186,7237313,7237587,7237595,7237598,7237618,7237622,7237627,7237628,7237630,7237631,7237632,7237633,
         7237634,7237725,7237727,7237729,7237862,7237866,7237870,7237878,7237899,7237901,7237913,7237915,7237916,7237920,7237994,7238016,7238160,7238353,7238374,
         7238375,7238382,7238383,7238387,7238388,7238389,7238391,7238471,7238509,7238514,7238515,7238525,7238528,7238539,7238555,7238568,7238573,7238581,7238612,
         7238856,7238862,7238909,7238913,7238914,7238915,7239192,7239207,7239235,7239270,7239315,7239398,7239772,7239773,7239779,7239781,7239783,7239788,7239928,
         7240539,7240544,7240611,7240613,7240615,7240617,7240679,7240732,7240754,7240804,7241048,7241055,7241056,7241057,7241116,7241124,7241125,7241127,7241201,
         7241264,7241290,7241341,7241394,7241402,7241439,7241441,7241519,7241962,7241978,7242060,7242690,7242693,7242694,7242695,7242696,7242776,7242782,7242885,
         7242921,7242997,7243000,7243006,7243007,7243011,7243014,7243082,7243086,7243105,7243108,7243109,7243111,7243196,7243220,7243260,7243364,7243386,7243496,
         7243541,7243586,7243617,7243622,7243628,7243632,7243639,7243645,7243677,7243735,7243813,7243961,7243969,7244041,7244042,7244043,7244044,7244045,7244058,
         7244060,7244064,7244065,7244083,7244086,7244090,7244167,7244174,7244194,7244197,7244200,7244291,7244323,7244330,7244352,7244382,7244383,7244617,7244619,
         7244620,7244634,7244637,7244654,7244660,7244664,7244770,7245041,7245530,7245533,7245546,7245552,7245558,7245562,7245565,7245593,7245686,7245967,7245980,
         7245995,7246044,7246063,7246078,7246380,7246383,7246393,7246394,7246395,7246397,7246399,7246400,7246403,7246408,7246438,7246525,7246527,7246725,7246726,
         7246727,7246775,7246781,7246785,7246788,7246793,7246882,7246884,7247063,7247064,7247066,7247067,7247072,7247078,7247080,7247081,7247082,7247084,7247087,
         7247193,7247194,7247195,7247197,7247198,7247202,7247203,7247254,7247255,7247343,7247795,7247799,7247809,7247819,7247820,7247821,7247822,7247823,7247825,
         7247829,7247830,7247831,7247832,7247847,7247849,7247922,7248082,7248087,7248110,7248111,7248112,7248113,7248115,7248117,7248118,7248119,7248120,7248213,
         7248284,7248285,7248286,7248287,7248431,7248433,7248437,7248438,7248439,7248441,7248442,7248443,7248445,7248446,7248448,7248489,7248490,7248564,7248571,
         7224869
         ];

	var userPid;		
	if (isIE) {
		userPid = parseInt(findPID(), 10);
	} else {
	    userPid = 0;
	}

	function _checkIsInPidList() {
		for	(i = 0; i < pidList.length; i += 1) {
			if (pidList[i] === userPid) {
				return true;
			}
		}
		return false;
	}

	function _checkIsCC() {
		return (window.location.host.indexOf(".cc.") !== -1);
	}

	function _check(name) {
		return features[name];
	}
	
	function _getPid() {
		return userPid;
	}

	var _always = true;
	var _never = false;	
	var _testing = _checkIsCC();
	var _isInPidList = _checkIsInPidList();
	var features = {
		isIE: isIE,
	
		autosave: _always,
		budget: _always,
		contactMenu: _always,
		fastScroll: _always,
		modular:  _always,
		stats: _always,		

		hideHowto: _isInPidList,
		histManager: _never,
		navbuttons: _never,
		
        colours: _isInPidList,
		keyboardNavigation: _testing,
		toc: _testing,
		howtoFun: _testing,
		
		pidList: _isInPidList,
		
		voiceId: _never,		
		progress: _never,		
		noteIcons: _never // _isCC,
	};	

	return {
		check: _check,
		getPid: _getPid
	}

})();